import{T as x,B as p,D as h,n as u}from"./index-DcLhZ31v.js";import{g as i}from"./colorToUniform-CDCsqgdE.js";const v={};function _(n,t){let e=2166136261;for(let a=0;a<t;a++)e^=n[a].uid,e=Math.imul(e,16777619),e>>>=0;return v[e]||C(n,t,e)}let r=0;function C(n,t,e){const a={};let s=0;r||(r=i());for(let c=0;c<r;c++){const l=c<t?n[c]:x.EMPTY.source;a[s++]=l.source,a[s++]=l.style}const o=new p(a);return v[e]=o,o}class d{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const a=h.get().createCanvas();a.width=t,a.height=e;const s=a.getContext("2d");return{canvas:a,context:s}}getOptimalCanvasAndContext(t,e,a=1){t=Math.ceil(t*a-1e-6),e=Math.ceil(e*a-1e-6),t=u(t),e=u(e);const s=(t<<17)+(e<<1);this._canvasPool[s]||(this._canvasPool[s]=[]);let o=this._canvasPool[s].pop();return o||(o=this._createCanvasAndContext(t,e)),o}returnCanvasAndContext(t){const e=t.canvas,{width:a,height:s}=e,o=(a<<17)+(s<<1);t.context.clearRect(0,0,a,s),this._canvasPool[o].push(t)}clear(){this._canvasPool={}}}const B=new d;export{B as C,_ as g};
